{"componentChunkName":"component---src-pages-lab-rock-paper-scissors-index-js","path":"/lab/rock-paper-scissors/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"more-about-experiment\" style=\"position:relative;\"><a href=\"#more-about-experiment\" aria-label=\"more about experiment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>More About Experiment</h2>\n<p>I hope you had a great time playing the game and now you are ready to understand what it took me to build it.</p>\n<h3 id=\"baseline\" style=\"position:relative;\"><a href=\"#baseline\" aria-label=\"baseline permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Baseline</h3>\n<p>All machine learning experiments start with data. I wanted to find some open source datasets I would be able to use to build a quick baseline.</p>\n<p>Fortunately, I could find a few datasets on Kaggle that seemed to match the goal. Namely, I picked:</p>\n<ul>\n<li><a href=\"https://www.kaggle.com/frtgnn/rock-paper-scissor\" target=\"_blank\" rel=\"noopener noreferrer\">[Kaggle] frtgnn/rock-paper-scissor dataset</a></li>\n</ul>\n<p>Here are how samples from the dataset look like:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACLElEQVQoz02S608TURDF9x8lJoZEY0KMMfERIwpoQOMH+aCIEIImaAivgFDlYQtSoVbQ0IeElgKlpbVdu8VtaXv39TN3l1Ymmcyd3Dtn5s45im3bNN2yLES97p6bZggDy/Jyx3FaselNa+aKLDaEIH+QRM2dkN7bdR+cVSpujIfDBH0fyaRSbi7fXwTTyxqlfK4FrFimie045BJxopsbHO3tuReJnR22v6yxGw7x5uljttcCREIhHOccUIILweb0OGOPugj6PnmAsmNN/0sm+oP1iXH8E5OUVBXbspgZGmRuZIjhrntMvR4g7F9pTVKv6ORiEWKBFeYHXtJ77TpqNoMiO52qBWKL02RDn/k+P8PJcdotyiQT9N/s4FnHVR5ebuN4P+HtS+72rEp8ycdheJOthQUG797hMB5FMU0T03bQ9n9y4J9ke3mOkqa5hRu+D7zvfcBw522629tIJ7x1SPKkFX5FyWyF2Fle5G3PfbRC3gM0TIuGrpFenSASDKBXqm5BuVggMDbCaE8n3Vfb+fM73yLGndQ00JIR4v4Fpvr7qJRLEtBACINGrUpmw8duaJ26ENi2N0U5n+VdXzfPb91wGb3ItDSh5UmtzbI0+orqaRnFMAwaDYFWKpJcnSUe9NMQAud8Cr2kMtPfx5Mrl/i2sugByi+fM41tocW+4h99walaRJGdZEfRaFDXy9SrOrb9X2dSVmr22NWn1GlL4C0tOpjVMsWjFKJW4x/xItMWhg4TSwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Samples from frtgnn/rock-paper-scissor dataset\" title=\"Samples from frtgnn/rock-paper-scissor dataset\" src=\"/static/441f18a103219fac79241873ad0cce0a/c5bb3/rps-dataset-preview.png\" srcset=\"/static/441f18a103219fac79241873ad0cce0a/04472/rps-dataset-preview.png 170w,\n/static/441f18a103219fac79241873ad0cce0a/9f933/rps-dataset-preview.png 340w,\n/static/441f18a103219fac79241873ad0cce0a/c5bb3/rps-dataset-preview.png 680w,\n/static/441f18a103219fac79241873ad0cce0a/b12f7/rps-dataset-preview.png 1020w,\n/static/441f18a103219fac79241873ad0cce0a/b5a09/rps-dataset-preview.png 1360w,\n/static/441f18a103219fac79241873ad0cce0a/e1250/rps-dataset-preview.png 1786w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Next, I chose a proper model architecture. I did not want to host my final model anywhere on an external server.</p>\n<p>This requirement effectively left me with one single option: to use a small-size model and deploy it to my existing static website via <a href=\"https://www.tensorflow.org/js\" target=\"_blank\" rel=\"noopener noreferrer\">TensorFlow.js</a>.</p>\n<p>This thought process brought me to <a href=\"https://arxiv.org/abs/1704.04861\" target=\"_blank\" rel=\"noopener noreferrer\">the MobileNet model architecture</a>.</p>\n<p>MobileNet is a popular 2M+ params network that performs very well considering its relatively tiny size. Fortunately, TensorFlow supports a few versions of MobileNet trained on <a href=\"https://www.image-net.org/\" target=\"_blank\" rel=\"noopener noreferrer\">the ImageNet dataset</a>. This meant that I was able to start training from the pre-trained weights. It was actually good as it helped to reduce training time considerably and relaxed a need for a large training dataset.</p>\n<p>I wasn't the only one on the Internet who was thinking about this idea, so I was quickly able to a good notebook to build my baseline on:</p>\n<ul>\n<li><a href=\"https://colab.research.google.com/github/trekhleb/machine-learning-experiments/blob/master/experiments/rock_paper_scissors_mobilenet_v2/rock_paper_scissors_mobilenet_v2.ipynb\" target=\"_blank\" rel=\"noopener noreferrer\">[Google Colab] trekhleb/rock-paper-scissors-mobilenet-v2</a></li>\n</ul>\n<p>Before doing any experiments I'd configured a few more things:</p>\n<ul>\n<li>configuration management with <a href=\"https://github.com/roma-glushko/morty\" target=\"_blank\" rel=\"noopener noreferrer\">Morty</a> which is my open source project to track ML/DL experiments</li>\n<li>experiment tracking with <a href=\"https://wandb.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Weights &#x26; Biases</a></li>\n</ul>\n<p>The baseline had been successfully established, however, the results of the model were not that good. It made a lot of misclassifications and it was too early to use it.</p>\n<h3 id=\"collecting-a-custom-dataset\" style=\"position:relative;\"><a href=\"#collecting-a-custom-dataset\" aria-label=\"collecting a custom dataset permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Collecting a Custom Dataset</h3>\n<p>One possible reason for that was the training dataset itself. I assumed that it's distributed differently than images I'd got from my webcam.</p>\n<p>Besides possible differences in the hidden technical attributes of photos, my images had different compositions. There were backgrounds, other parts of the body (not only one hand in the picture), different light conditions and things like that.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 34.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAACAUlEQVQozwXBz09SAQDA8dehzp06eMjhWoe2ULH0ibZBgIlCYgI95dcAgSc/8qnPtGT9EAHBErByWhMray01cy0PZW0tTZtbrXXsn/n2+QhjjhA+fRe37D5mXDGm3TLLgXFWxrOEOyXuhVMoriADRgdXm0zEHD5uSzJ+0YZikSg4ZXJSnMcehY2bRYRJyY9Yc5aoqRvJYiV+zYV83shc/zAdGj3FwQhfV59QSCbpFI1YRSOBZium01q8opkbNifx605GjXYKtjDCn+2X2Bp1ZFNxtnMTZIJ+rHVaih4Fh9aM0u/maOsFb2Ym2VicR+pxkfbK7FcrRMyXGfF7WJtWUe0OZH0XwqdShr4WkWadyJflArOxIObac+SlFGJdPTlFZiuf5n15hle5KT6srjLaF+L7gwzlgJNSZIBy1EPI0MFg6xWE9ZWn9Pf0EovGWVuq8Cyt0l5zhjtuGc2pWhIOOwdvn/O6nOfw8yb/fn4jo0yxMJogl4rwo/qQkreHuOESftGCcHhwiK5Rj8cb5PevI7KJMA0naxiRvBw/doI2jYa99Sqq082QxcLex02GkiqLj5aob9AzN5vj7/4upeEQruZ2hJ1363R2dKNrbKFcWqBwf5pAdy8VdRxfqwGTtonNyjwbMYWJ+jbmo0nG1DTlfJaLF9owW2zs7O5SzNxleMDHf/6OOquzFdymAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Me collecting samples for a custom rock-paper-scissors dataset\" title=\"Me collecting samples for a custom rock-paper-scissors dataset\" src=\"/static/2746e006200ff3d94e4d02c8fbac796c/c5bb3/rps-custom-dataset.png\" srcset=\"/static/2746e006200ff3d94e4d02c8fbac796c/04472/rps-custom-dataset.png 170w,\n/static/2746e006200ff3d94e4d02c8fbac796c/9f933/rps-custom-dataset.png 340w,\n/static/2746e006200ff3d94e4d02c8fbac796c/c5bb3/rps-custom-dataset.png 680w,\n/static/2746e006200ff3d94e4d02c8fbac796c/b12f7/rps-custom-dataset.png 1020w,\n/static/2746e006200ff3d94e4d02c8fbac796c/b5a09/rps-custom-dataset.png 1360w,\n/static/2746e006200ff3d94e4d02c8fbac796c/11d70/rps-custom-dataset.png 1802w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>So I decided not to spend much time trying fancy DL techniques for gradient optimization or learning rate schedule, but, instead, I started improving my dataset.</p>\n<p>The goal was clear. I needed to take hundreds of images that would be as close as possible to what I expected my model to work with.</p>\n<p>It wasn't super easy as it turned out. I had to group all of the images by classes (rock, paper, scissors). Also, I needed to track the number of images per each class to keep the distribution even among all classes. I needed some workflow to make it easy for me and possibly for other people that would decide to help me with this project.</p>\n<p>After a bit of thinking, I had come up with the following project:</p>\n<ul>\n<li><a href=\"https://github.com/roma-glushko/campy\" target=\"_blank\" rel=\"noopener noreferrer\">[Github] roma-glushko/campy project</a></li>\n</ul>\n<p>Campy is an Electron-based desktop application that can simply take photos of the same size and put them in the right class folder:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 71.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEBf/EABYBAQEBAAAAAAAAAAAAAAAAAAQAAf/aAAwDAQACEAMQAAABevOtxGiOR//EABsQAAICAwEAAAAAAAAAAAAAAAABAyECBBES/9oACAEBAAEFAnLxw5emUa9yn//EABYRAAMAAAAAAAAAAAAAAAAAAAIQQf/aAAgBAwEBPwEqv//EABYRAAMAAAAAAAAAAAAAAAAAAAECEP/aAAgBAgEBPwEpP//EABgQAAIDAAAAAAAAAAAAAAAAABARACFB/9oACAEBAAY/AlLD0//EABoQAQADAQEBAAAAAAAAAAAAAAEAESExQWH/2gAIAQEAAT8hQNK/Y4NjOMNg2sNeNxdvRlE//9oADAMBAAIAAwAAABAn7//EABYRAQEBAAAAAAAAAAAAAAAAAAEQQf/aAAgBAwEBPxAKLJ//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAECAQE/EIOmn//EABsQAQEBAAIDAAAAAAAAAAAAAAERACFBMVHB/9oACAEBAAE/EBwGUk9h9xkWS8kxhZ3pS3goD3xlS1qa94Ihv//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Campy UI\" title=\"Campy UI\" src=\"/static/fddfbff0245672241a0148f7bcb192eb/7bf67/campy.jpg\" srcset=\"/static/fddfbff0245672241a0148f7bcb192eb/651be/campy.jpg 170w,\n/static/fddfbff0245672241a0148f7bcb192eb/d30a3/campy.jpg 340w,\n/static/fddfbff0245672241a0148f7bcb192eb/7bf67/campy.jpg 680w,\n/static/fddfbff0245672241a0148f7bcb192eb/990cb/campy.jpg 1020w,\n/static/fddfbff0245672241a0148f7bcb192eb/c44b8/campy.jpg 1360w,\n/static/fddfbff0245672241a0148f7bcb192eb/e1596/campy.jpg 2048w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>The UI could have been sexier, but it'd done its job <span role=\"img\">😌</span></p>\n<p>Having Campy in place helped me to streamline dataset building.</p>\n<p>Another important thing is the test dataset. I chose to delegate this part to my girlfriend, so I would be more confident that my model was not learning what I looked like and would work with other people as well. Thankfully, girls like to take pictures, so I came with the right request:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 34.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAACDklEQVQozwXB209SAQDA4bNZW2tutVULK7zMC1Zamokdb6Dg8YAoQp4jKk1BDCRCrCnJ8patTHLO6TSdlot0ta40s9tcl4d68KXWS+utx/6KX98n9KgeFFMzbfUttFlbcJoasVXVE+4OopibsRusNNbUcScaYfvZA3xdHUQu9qHW2bkW8PLz/Steri0hSzIdiguhPLcU7e40DqXsw9Mkc3sgQq4mE0k0kZOqxZhVwIGUXbRWl5FciBPuUrFUyuTu13BeLObx5CgfE/coOX6CbI0WwXCyAkd5LU5Jwmdv4G1iGYMoIhllqrWFRJ0q5rPFSLpsfj1dYyLiwWmyUXQ0CzHjCMuDEf7tfMElm8nTZiA4jFY2Jm+QjN8iHvSTXJylsaoCh9mG5Uwl/moDU31B9NmZTPd5UKQSfC43urRMCg4fZPyCyvbKHJtLMySGBxHGe/38/vaJ+ZEY190K/Z2tGAvz8ba6KTXWUZuewYTqYOvRChMDIfQ6DZcD3RTr8qjKy2Im4GFnY5WvC9PcH4kifHiySizsZ++eVEZD3cilp7GUFRHqDZCffow2XQ4RUc+bsSFez0xRoy/Ap9pwiEVErTWsh/18X54l3GxhKNiD8PfPD2L9YXT5pxgeuIrXpTLo72Tz+TpS5Tl8TTJj7SoPQ5dYj0X5/O4Fi/GbJOem2Jq/y0L0CkNeN6rdRrui8B/lEig2hws2agAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Test Dataset\" title=\"Test Dataset\" src=\"/static/5476c7bbb7a386f4dfedd2b2606d8dfd/c5bb3/rps-custom-test-dataset.png\" srcset=\"/static/5476c7bbb7a386f4dfedd2b2606d8dfd/04472/rps-custom-test-dataset.png 170w,\n/static/5476c7bbb7a386f4dfedd2b2606d8dfd/9f933/rps-custom-test-dataset.png 340w,\n/static/5476c7bbb7a386f4dfedd2b2606d8dfd/c5bb3/rps-custom-test-dataset.png 680w,\n/static/5476c7bbb7a386f4dfedd2b2606d8dfd/b12f7/rps-custom-test-dataset.png 1020w,\n/static/5476c7bbb7a386f4dfedd2b2606d8dfd/b5a09/rps-custom-test-dataset.png 1360w,\n/static/5476c7bbb7a386f4dfedd2b2606d8dfd/81315/rps-custom-test-dataset.png 1656w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>As a result, we were able to collect:</p>\n<ul>\n<li>360+ files per each class in the train dataset</li>\n<li>260+ files per each class in the validation dataset</li>\n<li>150+ files per each class in the test dataset</li>\n</ul>\n<p>You can find the final dataset on Kaggle:</p>\n<ul>\n<li><a href=\"https://www.kaggle.com/glushko/rock-paper-scissors-dataset\" target=\"_blank\" rel=\"noopener noreferrer\">[Kaggle] glushko/rock-paper-scissors-dataset dataset</a></li>\n</ul>\n<p>For training my model, I used not only images I had taken but also the whole dataset I used to train my baseline model on.</p>\n<h3 id=\"fine-tuning\" style=\"position:relative;\"><a href=\"#fine-tuning\" aria-label=\"fine tuning permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Fine-Tuning</h3>\n<p>The custom dataset helped quite a lot, but there were still a noticeable number of errors.</p>\n<p>With my initial model architecture, there was merely one single dense layer that was training at that point. It wasn't really enough to gain a good accuracy in this task. So I went for fine-tuning of my MobileNet network.</p>\n<p>I took the best configs I was able to get at that point and started to unfreeze more layers starting from the end of the MobileNet feature extractor. With the RMSProp optimizer and 55 unfrozen layers\nlayers, I was able to get 93% accuracy on my test dataset and significantly reduce the number of misclassifications which was a way more important for the game.</p>\n<p>I ended up with the model that was trained for 50 epochs with:</p>\n<ul>\n<li>MobileNetV2 (55 unfeezed layers)</li>\n<li>RMSprop optimizer (I could not beat it <span role=\"img\">😄</span>) with 0.01 L2 regularization</li>\n<li>Small learning rate (10-4)</li>\n</ul>\n<h3 id=\"deployment\" style=\"position:relative;\"><a href=\"#deployment\" aria-label=\"deployment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Deployment</h3>\n<p>I did not want to buy any servers or cloud instances to run my tiny little pet project. That was a challenging requirement that left me with few options. The most solid one was to use Tensorflow.js.</p>\n<p>Tensorflow.js is a JavaScript frontend library that can load Tensorflow models right into the browser and use them to perform predictions.</p>\n<p>You will need to <a href=\"https://www.tensorflow.org/js/tutorials/conversion/import_keras\" target=\"_blank\" rel=\"noopener noreferrer\">convert</a> a Tensorflow model to Tensorflow.js compatible format. This is only possible if you persisted the whole model and not just only the model weights.</p>\n<p>Next, your model may fail to load in Tensorflow.js if you used any layers in your Tensorflow model that don't map to any layers on Tensorflow.js side. In my case, I used L2 normalization and I had to implement a new layer to map it on the JS side.</p>\n<p>After the model is loaded, it may be very slow at the very first prediction, so you may need to call run your predict method on the dummy tensor to warm up the model during the model initialization.</p>\n<p>Finally, Tensorflow.js and your model may add a few megabytes to your download resources that can be harmful to your frontend performance. So be sure you load your model weights and Tensorflow.js only where and when they are needed.</p>\n<h3 id=\"conclusions\" style=\"position:relative;\"><a href=\"#conclusions\" aria-label=\"conclusions permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Conclusions</h3>\n<p>I noticed that building AI-enabled applications, even simple ones, is quite a different story than training models in Jupyter notebooks just for the sake of training and getting the best possible score. You stop evaluating the success of your project by some metrics and you are getting focused on how well your project solves your problem.</p>\n<h2 id=\"resources\" style=\"position:relative;\"><a href=\"#resources\" aria-label=\"resources permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Resources</h2>\n<ul>\n<li><a href=\"https://github.com/roma-glushko/rock-paper-scissors\" target=\"_blank\" rel=\"noopener noreferrer\">[Github] roma-glushko/rock-paper-scissors project</a></li>\n<li><a href=\"https://github.com/roma-glushko/romaglushko.com-lab/tree/master/rock-paper-scissors\" target=\"_blank\" rel=\"noopener noreferrer\">[Github] Trained Tensorflow.js model</a></li>\n<li><a href=\"https://www.kaggle.com/glushko/rock-paper-scissors-dataset\" target=\"_blank\" rel=\"noopener noreferrer\">[Kaggle] glushko/rock-paper-scissors-dataset dataset</a></li>\n<li><a href=\"https://trekhleb.dev/machine-learning-experiments/#/experiments/RockPaperScissorsMobilenetV2\" target=\"_blank\" rel=\"noopener noreferrer\">[trekhleb.dev] Rock Paper Scissors (MobilenetV2)</a></li>\n</ul>"}},"pageContext":{}},"staticQueryHashes":["1546741752","3019904396"]}