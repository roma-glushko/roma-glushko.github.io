<!DOCTYPE html><html lang="en" class="blogpost-view-page"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.b53dcb80c8adc2c5ce8a.css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.view-page-header-wrapper{display:flex;justify-content:center}.view-page-header-wrapper .logo-wrapper{align-items:center;display:flex}.view-page-header-wrapper .logo{border:1px solid var(--avatarBorderColor);border-radius:50%;height:90px;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:90px}.view-page-header-wrapper .logo-img{width:5rem;height:auto;border-radius:50%;transform:translate(5px,5px);-ms-transform:translate(5px,5px);-webkit-transform:translate(5px,5px)}.view-page-header-wrapper .name{font-size:2rem;padding-left:.5rem;margin-top:.2rem;margin-bottom:.2rem}.view-page-header-wrapper .blog-title{color:var(--thoughtsPageTitleColor);font-family:Dancing Script,cursive;font-size:4rem;font-weight:700;margin-top:auto;margin-bottom:auto;padding-left:1.5rem;text-align:center}@media (max-width:575px){.view-page-header-wrapper .blog-title{font-size:3rem;line-height:3rem;padding-left:1rem}.view-page-header-wrapper .name{font-size:1.5rem}.view-page-header-wrapper .logo{width:90px;height:90px}.view-page-header-wrapper .logo-img{width:5rem}}.view-page-header-wrapper .blog-title a{color:var(--thoughtsPageTitleColor)}.thought-author-wrapper{text-align:center}.thought-author-wrapper .avatar{margin:0 auto;border-radius:50%;width:122px;height:122px;border:1px solid var(--avatarBorderColor)}.thought-author-wrapper .logo-img{width:7rem;height:auto;border-radius:50%;transform:translate(5px,5px);-ms-transform:translate(5px,5px);-webkit-transform:translate(5px,5px)}.thought-author-wrapper .name{font-size:2rem;margin-top:.2rem;margin-bottom:.2rem}.thought-author-wrapper .thought-section-descr{font-size:.9rem;margin-top:0;margin-bottom:0}.main-navigation ul{display:flex;justify-content:center;padding-left:0;text-align:center}.main-navigation ul li{list-style:none;text-transform:lowercase}.main-navigation ul:last-child:after,.main-navigation ul li:before{content:"\2022";padding-left:5px;vertical-align:middle}.main-navigation ul:last-child:after{line-height:25px}.main-navigation ul li a{padding-left:5px;vertical-align:middle}body{--themeSwitcherTrackBackgroundColor:var(--grey);--themeSwitcherThumbBackgroundColor:var(--white)}body.dark{--themeSwitcherTrackBackgroundColor:var(--midnightDarker);--themeSwitcherThumbBackgroundColor:var(--grey)}.theme-switcher{text-align:center}.theme-switcher-toggler{touch-action:pan-x;display:inline-block;position:relative;cursor:pointer;background-color:transparent;border:0;padding:0;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.theme-switcher-track{width:50px;height:24px;padding:0;border-radius:30px;background-color:var(--themeSwitcherTrackBackgroundColor);transition:all .2s ease}.theme-switcher-toggler--checked .theme-switcher-thumb{transform:translateX(26px)}.theme-switcher-thumb{position:absolute;top:1px;left:1px;width:22px;height:22px;border-radius:50%;background-color:var(--themeSwitcherThumbBackgroundColor);box-sizing:border-box;transition:all .5s cubic-bezier(.23,1,.32,1) 0ms;transform:translateX(0)}.theme-switcher-input{display:none}body{--contentTextColor:var(--black);--contentNavColor:grey}body.dark{--contentTextColor:var(--white);--contentNavColor:#8b949e}.blog-content-nav-wrapper{height:100%}.blog-content-nav-wrapper h2{margin-bottom:.3rem;margin-left:-1.5rem}.blog-content-nav-wrapper ul.blog-content-nav{color:var(--contentNavColor);list-style:decimal;margin:0;padding-left:1.5rem;padding-right:1.2rem;position:-webkit-sticky;position:sticky;top:1rem}@media (prefers-contrast:high){.blog-content-nav-wrapper ul.blog-content-nav{color:var(--gray)}}.blog-content-nav-wrapper ul.blog-content-nav:hover{color:var(--gray)}.blog-content-nav-wrapper ul.blog-content-nav li a{color:var(--contentNavColor)}.blog-content-nav-wrapper ul.blog-content-nav li.active a{font-weight:700}.blog-content-nav-wrapper ul.blog-content-nav:hover li a{color:var(--gray)}@media (max-width:1200px){.blog-content-nav-wrapper h2{font-weight:500;letter-spacing:0;margin-top:0}.blog-content-nav-wrapper ul.blog-content-nav{color:var(--contentTextColor);font-size:1.4rem;letter-spacing:-.003em;line-height:1.6;margin-bottom:1.2rem;margin-top:0;text-align:justify}.blog-content-nav-wrapper ul.blog-content-nav li a{color:var(--contentTextColor)}.blog-content-nav-wrapper ul.blog-content-nav li.active a{font-weight:400}.blog-content-nav-wrapper ul.blog-content-nav li{margin-left:30px;margin-top:.8em}}body{--blogHeaderColor:var(--red);--blogTagColor:grey}body.dark{--blogHeaderColor:var(--pink);--blogTagColor:var(--grey)}.blog-wrapper header{max-width:43rem;margin:auto;padding:1rem}.blog-wrapper h1{color:var(--blogHeaderColor);font-size:3rem;line-height:4rem;margin-bottom:1rem;margin-top:1rem;text-align:center}@media (max-width:575px){.blog-wrapper h1{font-size:2rem;line-height:3rem}}.blog-wrapper .blog-details{margin-bottom:1rem}.blog-wrapper .blog-createdat{font-weight:400}.blog-wrapper .theme-switcher{float:right;margin-left:1rem;margin-top:0}.blog-wrapper .cover,.blog-wrapper .cover-filter{left:50%;margin-left:-50vw;overflow:hidden;position:relative;width:100vw}.blog-wrapper .cover{max-height:600px}ul.blog-tags{display:flex;font-size:.9rem;flex-direction:row;flex-wrap:wrap;justify-content:center;list-style:none;padding:0;text-align:center}ul.blog-tags li{border:1px solid var(--blogTagColor);border-radius:4px;color:var(--blogTagColor);padding:5px 10px;margin-right:5px;margin-bottom:5px;white-space:nowrap}.blog-wrapper .content-wrapper{display:grid;grid-template-columns:1fr 43rem 1fr;margin:auto 0;padding:1rem}@media (max-width:1200px){.blog-wrapper .content-wrapper{display:block}}body{--thoughtHeaderColor:var(--red)}body.dark{--thoughtHeaderColor:var(--pink)}.thought-wrapper h1{color:var(--thoughtHeaderColor);font-size:3rem;line-height:4rem;margin-bottom:1rem;margin-top:1rem;text-align:center}@media (max-width:575px){.thought-wrapper h1{font-size:2rem;line-height:3rem}}.thought-wrapper .thought-details{font-size:.9rem;margin-bottom:1rem}.thought-wrapper .thought-createdat{font-weight:400}.thought-wrapper .theme-switcher{float:right;margin-left:1rem;margin-top:0}.thought-wrapper .cover,.thought-wrapper .cover-filter{left:50%;margin-left:-50vw;overflow:hidden;position:relative;width:100vw}.thought-wrapper .cover{max-height:600px}body{--backquoteBorderColor:var(--red);--imageTitleColor:grey}body.dark{--backquoteBorderColor:var(--pink);--imageTitleColor:#8b949e}.content h2,.content h3,.content h4,.content h5,.content h6{font-weight:500;letter-spacing:0;margin-top:1.95em;margin-bottom:-.3em}.content h2:first-of-type{margin-top:0}.content,.content p{font-size:1.4rem;letter-spacing:-.003em;line-height:1.6;margin-bottom:1.2rem;margin-top:.5rem;text-align:justify}.content p{margin-top:2rem}.content p:first-letter{padding-left:1.5rem}.content ul{padding:0}.content ul ol{padding:0;margin:0}.content a{text-decoration:underline}.content ol li,.content ul li{margin-left:30px;margin-top:.8em}.content blockquote{box-shadow:var(--backquoteBorderColor) 3px 0 0 0 inset;font-size:1.3rem;font-style:italic;line-height:1.7;margin-left:-20px;padding-left:20px}@media (max-width:1200px){.content h2 .anchor{display:none}}@media (max-width:575px){.content blockquote{margin:.5rem}}.content .image-title{text-align:center}.content .image-title,.content .image-title a{color:var(--imageTitleColor);font-size:1.1rem}.content .gatsby-highlight{font-size:1rem}.content a.anchor{transform:translateX(-100%) translateY(-5%)}.content a.anchor .anchor-icon{fill:currentColor}body{--blogNavigationLinkColor:var(--red);--allPostsNavigationLinkColor:var(--black)}body.dark{--blogNavigationLinkColor:var(--pink);--allPostsNavigationLinkColor:var(--white)}.blog-navigation-wrapper{padding-left:1rem;padding-right:1rem}.blog-navigation-wrapper h3{font-size:1.5rem;text-align:center}.blog-navigation .nav-links{padding:0;text-align:center;width:100%}.blog-navigation .nav-links a{color:var(--blogNavigationLinkColor);display:block;font-weight:700;margin-bottom:.875rem;text-decoration:none}.blog-navigation a.all-posts{color:var(--allPostsNavigationLinkColor)}body{--thoughtNavigationLinkColor:var(--red);--allThoughtsNavigationLinkColor:var(--black)}body.dark{--thoughtNavigationLinkColor:var(--pink);--allThoughtsNavigationLinkColor:var(--white)}.thought-navigation-wrapper{padding-left:1rem;padding-right:1rem}.thought-navigation .nav-links{padding:0;text-align:center;width:100%}.thought-navigation .nav-links a{color:var(--thoughtNavigationLinkColor);display:block;font-weight:700;margin-bottom:.875rem;text-decoration:none}.thought-navigation a.all-thoughts{color:var(--allThoughtsNavigationLinkColor)}body{--black:#000;--blackLigher:#262626;--red:#e74c3c;--brownDarker:#5a4e3e}body,body.dark{--white:#fff;--grey:#ebebeb}body.dark{--pink:#ffa7c4;--midnight:#373c49;--midnightDarker:rgba(0,0,0,0.27)}body{--bodyBackgroundColor:var(--white);--bodyTextColor:var(--black);--linkColor:var(--black);--linkHoverColor:var(--red);--thoughtCoverBlendColor:var(--brownDarker);--thoughtCoverBlendMode:lighten}body.dark{--bodyBackgroundColor:var(--midnight);--bodyTextColor:var(--white);--linkColor:var(--white);--linkHoverColor:var(--pink)}@font-face{font-family:Ledger;font-weight:400;font-style:normal;font-display:swap}html{scroll-behavior:smooth}body{color:var(--bodyTextColor);background-color:var(--bodyBackgroundColor);box-sizing:border-box;font-family:Ledger,serif;margin:0;text-rendering:optimizeLegibility;transition:color .2s ease-out,background .2s ease-out;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}a{color:var(--linkColor);text-decoration:none}a:hover{color:var(--linkHoverColor)}.avatar{border:1px solid var(--avatarBorderColor);border-radius:50%;height:170px;margin:0 auto;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:170px}.logo-img{border-radius:50%;width:10rem;height:auto;transform:translate(5px,5px)}.clearfix{clear:both}.cover-filter{background-color:var(--thoughtCoverBlendColor)}.cover-filter .cover{mix-blend-mode:var(--thoughtCoverBlendMode);-webkit-user-select:none;-ms-user-select:none;user-select:none}body.dark .cover-filter{-webkit-filter:brightness(.5);filter:brightness(.5)}.not-found-page body,.not-found-page body>div,.not-found-page body>div>div,.not-found-page body>div>div>div,html.not-found-page{height:100%}.not-found-page .row{flex-direction:column}.not-found-wrapper h1{font-size:2.5rem;margin-bottom:1rem;text-align:center;text-transform:uppercase}.not-found-wrapper{text-align:center}.not-found-wrapper p{margin:0}.not-found-wrapper .not-found-img{width:10rem;margin:0 auto;border-radius:50%}.not-found-wrapper .theme-switcher-toggler{margin-top:1rem}.blog-item{list-style:none;margin-bottom:2rem}.blog-item h2{font-size:1.6rem;line-height:2.4rem;margin-top:0;margin-bottom:.5rem}.blog-item h2 a{color:var(--thoughtTeaserHeaderLinkColor)}.blog-item p.blog-digest{font-size:1rem;line-height:1.6rem;margin-bottom:1.2rem;margin-top:.5rem}.blog-item .blog-details{font-size:.8rem;margin-bottom:.5rem}.blog-created-at{font-weight:600;text-transform:uppercase}.blog-item ul.blog-tags{font-size:.8rem;justify-content:start}.cv-header-wrapper{text-align:center}.cv-header-wrapper .avatar{border:none;margin:0 auto;width:8rem;height:8rem}.cv-header-wrapper .logo-img{width:8rem;height:8rem;border-radius:50%;transform:translate(5px,5px);-ms-transform:translate(5px,5px);-webkit-transform:translate(5px,5px)}.cv-header-wrapper .cv-name{font-size:3rem;margin-top:.2rem;margin-bottom:.2rem}.cv-header-wrapper .cv-position{font-size:1rem;margin-top:0;margin-bottom:1rem}@media print{.cv-header-wrapper .avatar{width:4.2rem;height:4.2rem}.cv-header-wrapper .logo-img{width:4rem;height:4rem}.cv-header-wrapper .cv-name{font-size:1.5rem}.cv-header-wrapper .cv-position{font-size:.7rem}}.thought-item{list-style:none;margin-bottom:2rem}.thought-item h2{font-size:1.6rem;line-height:2.4rem;margin-top:0}.thought-item h2 a{color:var(--thoughtTeaserHeaderLinkColor)}.thought-item p.thought-digest{font-size:1rem;line-height:1.6rem;margin-bottom:1.2rem;margin-top:.5rem}.thought-item .thought-details{font-size:.8rem;margin-bottom:.5rem}.thought-createdat{font-weight:600;text-transform:uppercase}.hero-header{background-size:cover;background-position:50%;height:40rem;position:relative;overflow:hidden;width:100%;z-index:1}.hero-header canvas{height:100%;width:100%}.hero-header h1.title{position:absolute;pointer-events:none;font-size:4rem;line-height:1.2;padding:0;margin:0;text-align:center;top:50%;width:100%;transform:translate3d(0,-50%,0)}.hero-header .title .highlight{color:var(--thoughtsPageTitleColor)}.hero-header .title .subscript{font-size:3rem}body{--liveCircleColorOn:rgba(231,76,60,0.2);--liveCircleColorOff:rgba(231,76,60,0)}body.dark{--liveCircleColor:rgba(255,167,196,0.5);--liveCircleColorOff:rgba(255,167,196,0)}.lab-header{background-size:cover;background-position:50%;height:40rem;position:relative;overflow:hidden;width:100%;z-index:1}.lab-header canvas{height:100%;width:100%}.lab-header h1.title{position:absolute;pointer-events:none;font-size:4rem;line-height:1.2;padding:0;margin:0;text-align:center;top:50%;width:100%;transform:translate3d(0,-50%,0)}.lab-header .title .highlight{color:var(--thoughtsPageTitleColor)}.lab-header .title .subscript{font-size:3rem;position:relative}.lab-header .title .after{font-size:3rem}.live-circle{background-color:var(--thoughtsPageTitleColor);border-radius:50%;position:absolute;right:-14px;top:14px;width:10px;height:10px}.pulse{animation:live-pulse 2s infinite}@keyframes live-pulse{0%{box-shadow:0 0 0 0 var(--liveCircleColorOn)}to{box-shadow:0 0 0 10px var(--liveCircleColorOff)}}body{--thoughtTeaserHeaderLinkColor:var(--red)}body.dark{--thoughtTeaserHeaderLinkColor:var(--pink)}.experiment-item{list-style:none;margin-bottom:2rem;text-align:center}.experiment-item h2{font-size:1.6rem;line-height:2.4rem;margin-top:0;margin-bottom:.5rem;width:100%}.experiment-item h2 a{color:var(--thoughtTeaserHeaderLinkColor);width:100%}.experiment-item p.blog-digest{font-size:1rem;line-height:1.6rem;margin-bottom:1.2rem;margin-top:.5rem}.experiment-item .blog-details{font-size:.8rem;margin-bottom:.5rem}.experiment-created-at{font-weight:600;text-transform:uppercase}.experiment-item .experiment-preview{text-align:center}.experiment-item .experiment-preview svg{color:var(--blackLigher);padding:1rem}body{--nameColor:var(--red);--pdfBadgeColor:var(--brownDarker);--pdfBadgeHoverColor:var(--red)}body.dark{--nameColor:var(--pink);--pdfBadgeColor:var(--midnightDarker);--pdfBadgeHoverColor:var(--pink)}.cv{margin-top:1rem;max-width:80rem;margin-left:auto;margin-right:auto}.cv .pdf-badge{border-left:50px solid transparent;border-bottom:50px solid transparent;border-right:50px solid var(--pdfBadgeColor);border-top:50px solid var(--pdfBadgeColor);position:fixed;top:0;right:0;width:0;height:0;cursor:pointer}.cv .cv-name{color:var(--nameColor)}.cv ul{padding-left:1.5rem}.cv .pdf-badge:hover{border-left-color:transparent;border-bottom-color:transparent;border-right-color:var(--pdfBadgeHoverColor);border-top-color:var(--pdfBadgeHoverColor)}.cv .pdf-badge a{color:#fff;font-weight:700;height:100%;left:1rem;position:absolute;top:-2.3rem;transform:rotate(45deg);text-transform:uppercase;text-decoration:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:100%}.cv a{font-weight:700;text-decoration:underline}.cv .main-navigation a{font-weight:400;text-decoration:none}.cv .social-list .social-item{margin-left:1rem}.cv .social-list .social-item svg{font-size:1.5rem}.cv-content{display:grid;grid-template-columns:30% 1fr;margin-top:1rem}@media screen and (max-width:768px){.cv-content{grid-template-columns:none}}.cv-content .cv-content-column{padding:1rem}.cv-content section h2{position:relative;font-size:2rem;overflow:hidden;text-align:center;z-index:1}.cv-content section h2 span{padding-left:1rem;padding-right:1rem}.cv-content section h2:after,.cv-content section h2:before{position:absolute;top:51%;overflow:hidden;width:50%;height:2px;content:"\A0";background-color:var(--bodyTextColor)}.cv-content section h2:before{margin-left:-50%;text-align:right}.notop-margin{margin-top:0}.cv .projects .project-description{margin-bottom:.8rem}.cv .projects .project ul.project-details{list-style-type:"\2605"}.cv .projects .project ul.project-details li{padding-left:.4rem}.cv .other-projects input{opacity:0}.cv .other-projects-link{text-align:right;display:none}.cv .other-projects .other-projects-list{display:none}.cv .other-projects label{cursor:pointer}.cv .other-projects input[type=checkbox]:checked~.other-projects-list{display:block}@media (max-width:768px){.cv-header-wrapper .cv-name{font-size:2.5rem}.cv-content section h2{font-size:1.5rem}.cv .pdf-badge{display:none}}@media print{body.dark{--nameColor:var(--red);--pdfBadgeColor:var(--brownDarker);--pdfBadgeHoverColor:var(--red);--bodyBackgroundColor:var(--white);--bodyTextColor:var(--black);--linkColor:var(--black);--linkHoverColor:var(--red)}.cv{font-size:.7rem}.cv ul{padding-left:1rem}.cv .social-list .social-item svg{font-size:1.3rem}.cv-content section h2{font-size:1rem;border-bottom:2px solid var(--bodyTextColor)}.cv .main-navigation,.cv .pdf-badge,.cv .theme-switcher{display:none}.cv-content .cv-content-column{padding:.5rem}.cv .social-list .social-item{margin-left:1rem}.cv .other-projects{display:none}.cv .other-projects-link{display:block}}body{--secondNameColor:var(--red);--storyLinkColor:var(--red);--socialLinkBorderHoverColor:var(--red)}body,body.dark{--avatarBorderColor:var(--grey);--socialLinkBorderColor:var(--grey)}body.dark{--secondNameColor:var(--pink);--storyLinkColor:var(--pink);--socialLinkBorderHoverColor:var(--pink)}.home-page body,.home-page body>div,.home-page body>div>div,.home-page body>div>div>div,html.home-page{height:100%}.container{height:100%;flex-direction:column;justify-content:center}.container,.row{display:flex;align-items:center}.column{flex:50% 1}.sidebar.column{flex:20% 1}@media (max-width:575.98px){.home-page body,.home-page body>div,.home-page body>div>div,.home-page body>div>div>div,html.home-page{height:auto}.container{margin-top:2.5rem;margin-bottom:2.5rem;padding-left:1rem;padding-right:1rem}.row{display:block}.my-story-content{text-align:justify}.column,.sidebar.column{width:100%}.social-item>a>svg{padding:20px}}.my-story-content{font-size:1.1rem;line-height:1.6;max-width:800px;text-align:justify}.my-story-content .intro{text-align:center}.my-story-content .intro .hey{margin-bottom:8px}.my-story-content .intro .title-summary{margin-top:0}.my-story-content a{color:var(--storyLinkColor);font-weight:700}.name{font-family:Dancing Script,cursive;font-size:3rem;margin-top:10px;margin-bottom:5px;text-align:center}.second-name{color:var(--secondNameColor)}.title{text-align:center;font-size:1.2rem;line-height:1.2rem}.home-page .theme-switcher{margin-top:10px}.homepage-sidebar .social{margin-top:20px}.social .social-list{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;justify-content:center;list-style:none;padding:0;margin:0}.homepage-sidebar .social .social-list .social-item{border:1px solid var(--socialLinkBorderColor);border-radius:50%;margin:.25rem}.homepage-sidebar .social .social-list .social-item:hover{border:1px solid var(--socialLinkBorderHoverColor)}.homepage-sidebar .social .social-list .social-item>a>svg{height:14px;padding:10px;vertical-align:middle;width:14px}body{--socialBackgroundColor:var(--white)}body.dark{--socialBackgroundColor:var(--midnight)}.homepagev2 .hero-intro{margin:0 auto;pointer-events:none;position:absolute;top:30%;width:100%}.homepagev2 .hero-intro .name{font-size:5rem}.homepagev2 .hero-header{height:60rem}.homepagev2 .avatar{background-color:var(--socialBackgroundColor)}.homepagev2 .main-navigation ul li{pointer-events:all}.homepagev2 .social-list .social-item{background-color:var(--socialBackgroundColor);pointer-events:all}.homepagev2 .theme-switcher{pointer-events:all}body{--footerIconColor:var(--blackLigher);--footerBgColor:var(--grey);--copyrightColor:var(--midnightDarker)}body.dark{--footerIconColor:var(--white);--footerBgColor:var(--midnightDarker);--copyrightColor:var(--grey)}footer{background-color:var(--footerBgColor)}footer,footer a{color:var(--footerIconColor)}footer .footer-wrapper{padding:4rem 1rem}.copyright{color:var(--copyrightColor);text-align:center}.footer-separator{display:flex;justify-content:center}.footer-separator .separator{background-color:#fff;width:3px;height:3px;border-radius:50%;margin-right:20px}footer .social-list .social-item{margin:.5rem}.copyright{font-size:1.1rem;margin:2rem auto 0}.blog-listing-wrapper{max-width:70rem;margin-left:auto;margin-right:auto}.experiment-grid{display:flex;max-width:70rem;margin:0 auto;justify-content:space-between;flex-wrap:wrap}.experiment-grid.no-experiments{justify-content:center}.blog-experiment .no-experiments-placeholder{padding:2rem;margin-bottom:32px;text-align:center}.experiment-grid .experiment-item{flex:0 1 30%;padding:10px}.experiment-grid .experiment-item .cover{height:200px}@media screen and (max-width:992px){.experiment-grid .experiment-item{flex:0 1 45%}}@media screen and (max-width:600px){.experiment-grid .experiment-item{flex:100% 1;flex-direction:column}.experiment-grid .experiment-item .cover{height:auto}}.game{display:flex;justify-content:center;padding:2rem}.game-item{margin:1rem}.game-item .title{margin-bottom:1rem}.player{width:300px;height:300px;border:1px solid #dcdfe6;border-radius:4px;box-shadow:0 2px 12px 0 rgb(0 0 0/10%);display:flex;align-items:center;justify-content:center;font-size:5rem}.human .choice{position:absolute}.controls{display:flex;flex-direction:column;align-items:center;justify-content:center}.controls .score{font-size:2rem;margin-bottom:1rem}.controls .countdown{font-size:3rem;font-weight:700}.controls button.play{display:inline-block;line-height:1;white-space:nowrap;cursor:pointer;background:#fff;border:1px solid #dcdfe6;color:#606266;-webkit-appearance:none;text-align:center;box-sizing:border-box;outline:none;margin:0;transition:.1s;font-weight:500;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;padding:12px 20px;font-size:14px;border-radius:4px}.video-background{position:relative;background-color:#666;transform:rotateY(180deg);-webkit-transform:rotateY(180deg);-moz-transform:rotateY(180deg)}.game-item .human-choice-image,.video-background{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.experiment-view-page .lab-header{height:30rem}.experiment-view-page .experiment-category{display:inline-block;line-height:1;white-space:nowrap;cursor:pointer;background:#fff;border:1px solid #dcdfe6;color:#606266;-webkit-appearance:none;text-align:center;box-sizing:border-box;outline:none;margin:0;transition:.1s;font-weight:500;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;padding:12px 20px;font-size:14px;border-radius:4px}.blog-wrapper{max-width:70rem;margin-left:auto;margin-right:auto}.blog-sidebar .blog-intro{font-size:1.1rem;margin-bottom:1rem;padding:0 5rem;text-align:center}.blog-sidebar{margin:2rem auto;max-width:45rem}.blog-sidebar .blog-header-wrapper{margin-bottom:1rem}.blog-sidebar .misc{display:flex;justify-content:space-around}@media screen and (max-width:575px){.blog-sidebar{margin:1rem 0}.blog-sidebar .blog-header-wrapper{margin-bottom:1rem}.blog-sidebar .blog-intro{padding:0 1rem}}.blog-grid{display:flex;justify-content:space-between;flex-wrap:wrap}.blog-grid.no-posts{justify-content:center}.blog-grid .no-posts-placeholder{padding:2rem;margin-bottom:32px;text-align:center}.blog-grid .blog-item{flex:0 1 30%;padding:10px}.blog-grid .blog-item .cover{height:200px}@media screen and (max-width:992px){.blog-grid .blog-item{flex:0 1 45%}}@media screen and (max-width:600px){.blog-grid .blog-item{flex:100% 1;flex-direction:column}.blog-grid .blog-item .cover{height:auto}}body{--thoughtsPageTitleColor:var(--red)}body.dark{--thoughtsPageTitleColor:var(--pink)}.thoughts-wrapper{max-width:70rem;margin-left:auto;margin-right:auto}.thoughts-wrapper .thought-sidebar{float:left;position:-webkit-sticky;position:-moz-sticky;position:-ms-sticky;position:-o-sticky;position:sticky;top:2rem;width:33.3%}@media (max-width:575.98px){.thoughts-wrapper .thought-sidebar{float:none;position:static;margin-bottom:40px;width:auto}}.thought-sidebar .navigation{text-align:center}.thought-sidebar .navigation a{text-transform:uppercase}.thought-sidebar .theme-switcher{margin-top:10px}.thoughts-wrapper .thoughts-list{float:left;padding-left:5rem;margin-right:0;margin-top:0;width:calc(66.6% - 5rem)}@media (max-width:1199.98px){.thoughts-wrapper .thoughts-list{padding-left:4rem;width:calc(66.6% - 4rem)}}@media (max-width:920px){.thoughts-wrapper .thoughts-list{padding-left:2rem;width:calc(66.6% - 2rem)}}@media (max-width:575.98px){.thoughts-wrapper .thoughts-list{float:none;display:block;padding-left:1rem;padding-right:1rem;width:auto}}@media (max-width:575.98px){.thought-sidebar .theme-switcher{margin-top:1rem}}.thoughts-title{font-family:Dancing Script,cursive;font-size:4rem;font-weight:700;margin-top:2.5rem;margin-bottom:2.5rem;text-align:center}.thoughts-title,.thoughts-title a{color:var(--thoughtsPageTitleColor)}body{--socialShareBorderHoverColor:var(--red)}body.dark{--socialShareBorderHoverColor:var(--pink)}.social-share-wrapper{font-size:1.5rem;text-align:center;margin-bottom:1.2rem}.social-share-wrapper h3{font-size:1.5rem}.social-share-wrapper .social-share-item{margin-right:.8rem;vertical-align:middle}.social-share-wrapper .social-share-item:hover{color:var(--socialShareBorderHoverColor)!important}.newsletter-form{max-width:50rem;margin-left:auto;margin-right:auto;padding-left:5px;padding-right:5px}.newsletter-form iframe{background:var(--bodyBackgroundColor)}.blogpost-view-page .blogpost-header{margin:1rem 0}.blogpost-view-page .blog-header-wrapper .logo{width:90px;height:90px}.blogpost-view-page .blog-header-wrapper .logo-img{width:5rem}.blogpost-view-page .blog-header-wrapper .name{font-size:1.5rem}.blogpost-view-page .blog-header-wrapper .blog-title{font-size:3rem;padding-left:1rem}.blogpost-view-page .thought-sidebar,.thought-wrapper{margin-left:auto;margin-right:auto;max-width:43rem}.blogpost-view-page .thoughts-title{font-size:3rem;margin-bottom:1rem}@media (max-width:575px){.blogpost-view-page .thoughts-title{font-size:2rem}}.blogpost-view-page .thought-divider{clear:both}.blogpost-view-page .thought-content{margin-top:2rem}.blogpost-view-page .thought-author-wrapper,.blogpost-view-page .thought-navigation-wrapper{margin-bottom:2rem}.blogpost-view-page hr{border:none;margin-bottom:2rem;text-align:center}.blogpost-view-page hr:before{letter-spacing:.6em;text-indent:.6em;content:"***"}body{--thoughtQuoteColor:var(--red)}body.dark{--thoughtQuoteColor:var(--pink)}.thought-view-page .thought-sidebar,.thought-wrapper{margin-left:auto;margin-right:auto;max-width:43rem}@media (max-width:767px){.thought-wrapper{display:block;padding-left:1rem;padding-right:1rem;width:auto}}.thought-view-page .thoughts-title{font-size:3rem;margin-bottom:1rem;margin-top:1rem}@media (max-width:575px){.thought-view-page .thoughts-title{font-size:2rem}}.thought-view-page .thought-divider{clear:both}.thought-view-page .thought-content{margin-top:2rem}.thought-view-page .thought-author-wrapper,.thought-view-page .thought-navigation-wrapper{margin-bottom:2rem}.thought-view-page hr{border:none;margin-bottom:2rem;text-align:center}.thought-view-page hr:before{letter-spacing:.6em;text-indent:.6em;content:"***"}</style><title data-react-helmet="true">Heapify ✌️ - Blog by Roman Glushko</title><meta data-react-helmet="true" name="image" property="og:image" content="https://www.romaglushko.com/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/35aef/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg"/><meta data-react-helmet="true" name="description" property="og:description" content="How the priority queue works. Heap sorting and other applications."/><meta data-react-helmet="true" name="keywords" content="algorithmic coding,data structures,python"/><meta data-react-helmet="true" name="author" content="@roma_glushko"/><meta data-react-helmet="true" property="og:title" content="Heapify ✌️ - Blog"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@roma_glushko"/><meta data-react-helmet="true" name="twitter:title" content="Heapify ✌️ - Blog"/><meta data-react-helmet="true" name="twitter:description" content="How the priority queue works. Heap sorting and other applications."/><meta data-react-helmet="true" property="og:url" content="https://www.romaglushko.com/blog/heapify/"/><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","image":"/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/35aef/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg","headline":"Heapify ✌️","dateCreated":"2021-05-09","dateModified":"2021-05-09","datePublished":"2021-05-09","inLanguage":"en-US","isFamilyFriendly":"true","author":{"@type":"Person","name":"Roman Glushko"},"publisher":{"@type":"Person","name":"Roman Glushko"},"mainEntityOfPage":"true","keywords":["algorithmic coding","data structures","python"],"genre":["opinion","thoughts","life experience"],"articleSection":"Thoughts","articleBody":"\nWhen you have a sequence of candidates to process, then you build a queue to organize them. In the classical queue, the time of adding an item to the queue defines when it's going to be processed.\n\nWhat if we need to change this principle and use some **relative importance score** to determine the item processing sequence?\n\nWell, then we would reinvent ~~bicycle~~ the priority queue.\n\n<div style=\"width:100%;height:0;padding-bottom:76%;position:relative;\"><iframe src=\"https://giphy.com/embed/3orif1K6QR54NlWzLO\" width=\"100%\" height=\"100%\" loading=\"lazy\" style=\"position:absolute\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe></div><p><a href=\"https://giphy.com/gifs/thesimpsons-the-simpsons-6x25-3orif1K6QR54NlWzLO\"></a></p>\n\n**The priority queue or heap** is a data structure that efficiently allows retrieving the next queued item with min or max importance score.\n\n## Nearly Complete Binary Tree\n\nThe heap can be represented as an array or a list that is visualized as a nearly complete binary tree:\n\n![Max Heap](./img/max-heap.png \"Max Heap\")\n<div class=\"image-title\">Max Heap</div>\n\nSince it's a binary tree, **all parent nodes** have **at max 2 children**. The binary tree is filled level by level from top to bottom, from left incomplete parent nodes (with none or one child) to right ones.\n\nWith such a node positioning, we can come up with formulas for finding parent/children nodes:\n\n- $element\\_idx / 2$ is the node parent index\n- $2 * element\\_idx$ is an index of the left child\n- $2 * element\\_idx + 1$ is an index of the right child\n\nwhere $element\\_idx$ is some node index.\n\nAdditionally, the binary tree has the following useful properties:\n\n- Heigh of the tree is $ln(N) + 1$\n\nThe \"nearly complete\" means that **not all tree levels** may be **filled out** by leaf nodes (nodes without children). In other words, we can have a heap with any number of items.\n\nThe heap has a distinct property that actually makes it helpful:\n\n- all children node values should be **less or equal** to the parent node value (**the max-heap property**)\n- or all children node values should be **greater or equal** to the parent node value (**the min-heap property**)\n\nTo explain how all of this can be useful, we are going to implement the main heap functions from scratch.\n## Heap Building\n\nThere is going to be a custom `PriorityQueue` class which takes an arbitrary array of integers, make a heap from it and sustain the heap property during all operations.\n\nThe first thing we need to do is to build a max heap from an unsorted array. We can already visualize the array as a heap, but it would **luck the max heap property**.\n\nNotice that **leaf nodes can't violate the heap property** since they don't have any child nodes. Hence, we can start looking at possible violations from the second-to-last level. The index of the last parent element on that level we can get via `n // 2` where `n` is the size of the array.\n\nWe start moving from right to left, from the bottom to the top of the heap. For each parent node, we need to make sure that the property of the heap holds true. If there is any violations, we just switch the current parent node with a child node that is greater than it (which violates the heap property).\n\nHowever, this switching of the nodes may create a new violation on the levels below. So we need to perform the same procedure again for a node that became a child.\n\n`video: title: \"Building a heap\": ./img/heapify.mp4`\n<div class=\"image-title\">Max Heapifying</div>\n\nHere is how this can be implemented:\n\n```python\nfrom typing import List\n\n\nclass PriorityQueue:\n\n    def __init__(self, items: List[int]):\n        self.items = self.build_heap(items)\n\n    def build_heap(self, items: List[int]) -> List[int]:\n        n = len(items)\n\n        for i in range(n // 2, -1, -1):\n            items = self.heapify(items, i)\n\n        return items\n\n    def heapify(self, items: List[int], node_idx: int) -> List[int]:\n        n = len(items)\n        largest_idx = node_idx\n\n        # formulas for zero-indexed arrays\n        left_child_idx = 2 * node_idx + 1\n        right_child_idx = 2 * node_idx + 2\n\n        if left_child_idx < n and items[left_child_idx] > items[largest_idx]:\n            largest_idx = left_child_idx\n\n        if right_child_idx < n and items[right_child_idx] > items[largest_idx]:\n            largest_idx = right_child_idx\n\n        if largest_idx != node_idx:\n            tmp = items[node_idx]\n            items[node_idx] = items[largest_idx]\n            items[largest_idx] = tmp\n\n            return self.heapify(items, largest_idx)\n\n        return items\n\n    def size(self) -> int:\n        return len(self.items)\n```\n\nComplexity of this algorithm is $\\Theta(n log(n))$.\n\n## Adding a New Element\n\nAnother useful method to have is adding a new item to the heap. In this case, it's convenient to add a new item as a leaf node in the end of the heap array. This makes sure there are no violations below it. However, there may be some going upward. That's why we need to go all the way up and check whenever parent nodes are greater than the new item. If they are not, we will switch their positions.\n\nSince the max heap property had stayed true before we add the new item, it's sufficient for us to check only parent nodes as we know that all child nodes should be less or equal to the parent value. \n\n`video: title: \"Insert a new item to the heap\": ./img/insert-a-new-item-to-the-heap.mp4`\n<div class=\"image-title\">Insert a new item to the heap</div>\n\nNow we can take a look at the implementation:\n\n```python\ndef push(self, item: int):\n    self.items.append(item)\n\n    idx = len(self.items) - 1\n    parent_idx = idx // 2\n\n    if idx % 2 == 0:\n        # calculating parents in zero-indexed array\n        parent_idx -= 1\n\n    while idx > 0 and self.items[idx] > self.items[parent_idx]:\n        tmp = self.items[parent_idx]\n        self.items[parent_idx] = self.items[idx]\n        self.items[idx] = tmp\n\n        idx = parent_idx\n        parent_idx = idx // 2\n\n        if idx % 2 == 0:\n            # calculating parents in zero-indexed array\n            parent_idx -= 1\n```\n\nThe complexity of heap inserting algorithm is $\\Theta(log(n))$ since at each interaction we traversal another tree level.\n\n## Extracting The Max Element\n\nThe key method of the heap is extracting the max element. Because of the heap property, the max element should always stay that the top of the heap. So it's as simple as call `self.items[0]` to get it.\n\nThat's not all. The extraction would remove the element from the heap and we can not just leave it with a \"hole\". Instead, we need to put the next max element there.\n\nLike before, the safest way is to **replace the hole with the last leaf node** (not to change the heap property in other branches of the heap). The last item is just handy to use, but it's not necessarily the next needed candidate to be at the top of the heap. To make sure, we need to run the `heapify()` method which recursively fixes all violations.\n\n`video: title: \"Extract the max element from the heap\": ./img/extract-max-element-from-the-heap.mp4`\n<div class=\"image-title\">Extract the max element from the heap</div>\n\nThe implementation is straightforward:\n\n```python\ndef pop(self):\n    item = self.items[0]\n\n    n = len(self.items)\n    self.items[0] = self.items[n - 1]  # replace extracted max element with one of the balanced leaves\n    del self.items[n - 1]\n\n    self.items = self.heapify(self.items, 0)\n\n    return item\n```\n\nThe complexity of heap items extracting algorithm is $\\Theta(log(n))$. Nevertheless, we can get access to the current max element in $\\Theta(1)$.\n\n## Heap Sort\n\nNow we have all components to implement one of the most frequent applications of the priority queue - the heap sorting.\n\nHeap sort is just the extraction of `n` elements from the heap.\n\n`video: title: \"Heap Sort In Action\": ./img/heap-sort.mp4`\n<div class=\"image-title\">Heap Sort In Action</div>\n\nThis is how it looks like in Python:\n\n```python\ndef heap_sort(heap: PriorityQueue) -> List[int]:\n    n = len(heap.size())\n    \n    result = []\n\n    for i in range(n):\n        result.append(heap.pop())\n\n    return result\n```\n\nThe complexity of heap sorting is $\\Theta(nlog(n))$. Besides that, heap sorting doesn't require any additional memory for storing elements during sorting.\n\n## Applications\n\nHeap sorting is not the only application of the priority queue. Here are a few more cases where heaps are being applied:\n\n- access to a limited resource like making sure your Zoom application has a high network bandwidth priority, hence, lower latency\n- device interruption handling like pressing a key on the keyboard triggers a specific interruption handler that rads a key value and send it to the OS. There is an interruption latency associated with this process and interruptions from some devices we wish to be processed as soon as possible\n- the heap can be used during searching for <a target=\"_blank\" rel=\"noopener nofollow\" href=\"/blog/k-nearest-neighbors/\">K-Nearest Neighbors</a>\n\nBroadly speaking, the heap may be used everywhere where we need to keep track of the list of min or max elements that may be changed during the runtime.\n\n## heapq\n\nThankfully, it's not required to implement the heap yourself everytime you need it. Python provides a library called <a target=\"_blank\" rel=\"noopener nofollow\" href=\"https://docs.python.org/3/library/heapq.html\">heapq</a> which is a set of functions that operates on the \"heapified\" array preserving the min-heap property.\n\nThe min-heap sort can be implemented this way:\n\n```python\nimport heapq\n\nheap = [2, 7, 26, 25, 19, 17, 1, 90, 3, 36]\nheapq.heapify(heap)\n\nresult = []\nn = len(heap)\n\nfor i in range(n):\n    result.append(heapq.heappop(heap))\n```\n\n## Practice\n\n- <a target=\"_blank\" rel=\"noopener\" href=\"https://leetcode.com/problems/last-stone-weight/\">[Leetcode] 1046. Last Stone Weight</a>\n- <a target=\"_blank\" rel=\"noopener\" href=\"https://leetcode.com/problems/single-threaded-cpu/\">[Leetcode] 1834. Single-Threaded CPU</a>\n- <a target=\"_blank\" rel=\"noopener\" href=\"https://leetcode.com/problems/find-k-th-smallest-pair-distance/\">[Leetcode] 719. Find K-th Smallest Pair Distance</a>\n\n## Summary\n\nIn this article, we have reviewed how to implement a priority queue, what properties it has and how it can be helpful.\n\nIf the heap concept was new for you, try to do a few problems from the practice section.\n\nFinally, let me in the comments what unusual applications of heaps have you seen in your practice.\n\n## References\n\n- <a target=\"_blank\" rel=\"noopener nofollow\" href=\"https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-006-introduction-to-algorithms-fall-2011/lecture-videos/lecture-4-heaps-and-heap-sort/\">MIT 6.006 - Heaps and Heap Sort</a>\n- <a target=\"_blank\" rel=\"noopener nofollow\" href=\"https://visualgo.net/en/heap\">Heap Visualized</a>","wordcount":1175}</script><script data-react-helmet="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async=""></script><link rel="icon" href="/favicon-32x32.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#ffffff"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=58a31253e5b93c1d7e74e8a017ff47b3"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v16/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v16/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/ledger/v11/j8_q6-HK1L3if_sBnMrx.woff2"/><style>@font-face{font-family:Dancing Script;font-style:normal;font-weight:400;font-display:swap;src:url(/static/webfonts/s/dancingscript/v16/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2) format("woff2")}@font-face{font-family:Dancing Script;font-style:normal;font-weight:700;font-display:swap;src:url(/static/webfonts/s/dancingscript/v16/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2) format("woff2")}@font-face{font-family:Dancing Script;font-style:normal;font-weight:400;font-display:swap;src:url(/static/webfonts/s/dancingscript/v16/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup6.woff) format("woff")}@font-face{font-family:Dancing Script;font-style:normal;font-weight:700;font-display:swap;src:url(/static/webfonts/s/dancingscript/v16/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup6.woff) format("woff")}@font-face{font-family:Ledger;font-style:normal;font-weight:400;font-display:swap;src:url(/static/webfonts/s/ledger/v11/j8_q6-HK1L3if_sBnMrx.woff2) format("woff2")}@font-face{font-family:Ledger;font-style:normal;font-weight:400;font-display:swap;src:url(/static/webfonts/s/ledger/v11/j8_q6-HK1L3if_sBnMr3.woff) format("woff")}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://www.romaglushko.com/blog/heapify/" data-baseprotocol="https:" data-basehost="www.romaglushko.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-9bd2d682a8ce326f2399.js"/><link as="script" rel="preload" href="/framework-210242e7bdc0a51564c1.js"/><link as="script" rel="preload" href="/app-a404a4d28af389c419da.js"/><link as="script" rel="preload" href="/styles-8636a280cbc61d53ad10.js"/><link as="script" rel="preload" href="/cb1608f2-6457b2b7ea9500c04ebb.js"/><link as="script" rel="preload" href="/a9a7754c-52ee971a981a422e7452.js"/><link as="script" rel="preload" href="/5b6787de1fc21416001f14661dbb6de4fdaa6cae-128c3c7f9700dacdcc25.js"/><link as="script" rel="preload" href="/96edb7a57f086d01df9dd5de2930bc5d14d74576-d1cec564a349ac9a8364.js"/><link as="script" rel="preload" href="/f6376c28e68891f114e55d85fa576119f254df6d-f70e1702cd36f0e54f95.js"/><link as="script" rel="preload" href="/4622c33586ad0108e870f951288ae6aa3beabfab-fcb43bc1a7ce17b71bb1.js"/><link as="script" rel="preload" href="/component---src-templates-blog-template-js-36c6e9a028bb065c2789.js"/><link as="fetch" rel="preload" href="/page-data/blog/heapify/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="blogpost-header"><div class="view-page-header"><div class="view-page-header-wrapper"><div class="logo-wrapper"><div class="logo"><div class="logo-img gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:100%"></div><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEEBf/EABYBAQEBAAAAAAAAAAAAAAAAAAIBBP/aAAwDAQACEAMQAAABtmSLU1KeLAa+iHm//8QAHBABAAICAwEAAAAAAAAAAAAAAQACAxIEISNB/9oACAEBAAEFAkuCLNbTNl1lczWHZd9vnHfL/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAECMRD/2gAIAQMBAT8BS5OFaf/EABYRAAMAAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPwGo/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAEQESES/9oACAEBAAY/ArMuOU9NLQxx/8QAHBABAAICAwEAAAAAAAAAAAAAAQARIVExYXGR/9oACAEBAAE/IXCVlFftHewg5k+Rq7IcxhphiNu2Lii09n//2gAMAwEAAgADAAAAEKAPfP/EABoRAAICAwAAAAAAAAAAAAAAAAABETEhQfD/2gAIAQMBAT8Qa0OVgt7Ref/EABcRAQEBAQAAAAAAAAAAAAAAAAAxARH/2gAIAQIBAT8Q2uNqH//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExUUFhcYGh/9oACAEBAAE/EKIFxuEXF2cBIp2+ZREzlLBC1DYAUnrr3irELKYzK1D7GCYEbhQw0tz/2Q==" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/7d8b62b999b9a2fb28b8ab360138da37/b13df/photo3.jpg 40w,
/static/7d8b62b999b9a2fb28b8ab360138da37/4e333/photo3.jpg 80w,
/static/7d8b62b999b9a2fb28b8ab360138da37/e75b5/photo3.jpg 160w,
/static/7d8b62b999b9a2fb28b8ab360138da37/40426/photo3.jpg 240w,
/static/7d8b62b999b9a2fb28b8ab360138da37/c01e2/photo3.jpg 320w,
/static/7d8b62b999b9a2fb28b8ab360138da37/b1563/photo3.jpg 3677w" sizes="(max-width: 160px) 100vw, 160px" /><img loading="lazy" sizes="(max-width: 160px) 100vw, 160px" srcset="/static/7d8b62b999b9a2fb28b8ab360138da37/b13df/photo3.jpg 40w,
/static/7d8b62b999b9a2fb28b8ab360138da37/4e333/photo3.jpg 80w,
/static/7d8b62b999b9a2fb28b8ab360138da37/e75b5/photo3.jpg 160w,
/static/7d8b62b999b9a2fb28b8ab360138da37/40426/photo3.jpg 240w,
/static/7d8b62b999b9a2fb28b8ab360138da37/c01e2/photo3.jpg 320w,
/static/7d8b62b999b9a2fb28b8ab360138da37/b1563/photo3.jpg 3677w" src="/static/7d8b62b999b9a2fb28b8ab360138da37/e75b5/photo3.jpg" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></div><div class="name"><a title="back to blog" href="/blog/">Roman <br/> Glushko</a></div></div><h2 class="blog-title"><a title="back to the homepage" href="/"></a></h2></div></div><nav class="main-navigation"><ul><li><a rel="home" title="Go Home" href="/">Home</a></li><li><a title="Go to Technical blog" href="/blog/">Blog</a></li><li><a title="Go to Thoughts" href="/thoughts/">Thoughts</a></li><li><a title="Review My CVs" href="/cv/machine-learning-engineer">CV</a></li></ul></nav></div><main><article class="blog-wrapper"><header><div class="cover-filter"><div class="cover gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:66.70588235294117%"></div><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAQb/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAABWyyqUI6QT//EABsQAAICAwEAAAAAAAAAAAAAAAECAxEAEyEy/9oACAEBAAEFAtMlLE2MCpHmY07N3//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/AYf/xAAbEAABBAMAAAAAAAAAAAAAAAABAAIQESNBYf/aAAgBAQAGPwIUwrIw8VGG7j//xAAaEAADAQEBAQAAAAAAAAAAAAAAAREhMUFh/9oACAEBAAE/IXQqRU9DyifGmcHSIaw/fpDhM//aAAwDAQACAAMAAAAQcx//xAAXEQADAQAAAAAAAAAAAAAAAAABEBEh/9oACAEDAQE/ELTq/8QAFxEBAAMAAAAAAAAAAAAAAAAAARARIf/aAAgBAgEBPxAoZH//xAAcEAEAAgMAAwAAAAAAAAAAAAABABEhMUFRkaH/2gAIAQEAAT8QHSujrXuY4hWxBe48RydcSo0Isi7jgCIFV8VqNS1jaXP/2Q==" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/809fc/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 850w,
/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/4f4f6/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 1700w,
/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/35aef/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 3400w,
/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/9a201/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 5100w,
/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/c128d/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 5760w" sizes="(max-width: 3400px) 100vw, 3400px" /><img loading="lazy" sizes="(max-width: 3400px) 100vw, 3400px" srcset="/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/809fc/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 850w,
/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/4f4f6/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 1700w,
/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/35aef/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 3400w,
/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/9a201/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 5100w,
/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/c128d/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg 5760w" src="/static/20fe662fa316fc9e5d4b4c6eaeaf84f6/35aef/markus-spiske-IiEFmIXZWSw-unsplash-min.jpg" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></div><h1>Heapify ✌️</h1><div class="blog-details"><time class="blog-createdat" dateTime="2021-05-09">May 9, 2021</time><span> • </span><span class="blog-time2read">7<!-- --> min read</span><div class="theme-switcher"><div class="theme-switcher-toggler"><div class="theme-switcher-track"></div><div class="theme-switcher-thumb"></div><input type="checkbox" class="theme-switcher-input" readonly="" aria-label="Switch between Dark and Light mode"/></div></div></div><ul class="blog-tags"><li>algorithmic coding</li><li>data structures</li><li>python</li></ul></header><div id="intro" class="blog-divider"></div><div class="content-wrapper"><div class="blog-content-nav-wrapper"><ul class="blog-content-nav"><h2>Content</h2><li class=""><a href="#intro">Intro</a></li></ul></div><div class="content blog-content"><p>When you have a sequence of candidates to process, then you build a queue to organize them. In the classical queue, the time of adding an item to the queue defines when it's going to be processed.</p>
<p>What if we need to change this principle and use some <strong>relative importance score</strong> to determine the item processing sequence?</p>
<p>Well, then we would reinvent <del>bicycle</del> the priority queue.</p>
<div style="width:100%;height:0;padding-bottom:76%;position:relative;"><iframe src="https://giphy.com/embed/3orif1K6QR54NlWzLO" width="100%" height="100%" loading="lazy" style="position:absolute" frameBorder="0" class="giphy-embed" allowFullScreen></iframe></div><p><a href="https://giphy.com/gifs/thesimpsons-the-simpsons-6x25-3orif1K6QR54NlWzLO"></a></p>
<p><strong>The priority queue or heap</strong> is a data structure that efficiently allows retrieving the next queued item with min or max importance score.</p>
<h2 id="nearly-complete-binary-tree" style="position:relative;"><a href="#nearly-complete-binary-tree" aria-label="nearly complete binary tree permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Nearly Complete Binary Tree</h2>
<p>The heap can be represented as an array or a list that is visualized as a nearly complete binary tree:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 28.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAvElEQVQY041PfwuCMBTc9/9kQoRJYggmzlYS2mQbtrlf9txAMAi6P8bxbu/uHlp+Q0o5DIO19mvuvY8EbSPn3ItSrbUI4Jw/uy7PMiCMMXiVlNM0Ad9WENhwISCEUno6HFqMQQa+BkJCCHkHte/7S56XRRHdpVKIjuMxSQghap7hqzYGY3xO01gvNhSMwZp1Dup5cHXu1jT3tkXXsgQZ1zXBGEhTVY9AtsNWQAtjdncHI7RovZOVWqDCf/gATA1af16+IZEAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Max Heap"
        title="Max Heap"
        src="/static/be0a11ae707f1a5968ed6d7e4217e3bf/c5bb3/max-heap.png"
        srcset="/static/be0a11ae707f1a5968ed6d7e4217e3bf/04472/max-heap.png 170w,
/static/be0a11ae707f1a5968ed6d7e4217e3bf/9f933/max-heap.png 340w,
/static/be0a11ae707f1a5968ed6d7e4217e3bf/c5bb3/max-heap.png 680w,
/static/be0a11ae707f1a5968ed6d7e4217e3bf/b12f7/max-heap.png 1020w,
/static/be0a11ae707f1a5968ed6d7e4217e3bf/b5a09/max-heap.png 1360w,
/static/be0a11ae707f1a5968ed6d7e4217e3bf/61583/max-heap.png 1616w"
        sizes="(max-width: 680px) 100vw, 680px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<div class="image-title">Max Heap</div>
<p>Since it's a binary tree, <strong>all parent nodes</strong> have <strong>at max 2 children</strong>. The binary tree is filled level by level from top to bottom, from left incomplete parent nodes (with none or one child) to right ones.</p>
<p>With such a node positioning, we can come up with formulas for finding parent/children nodes:</p>
<ul>
<li>$element\_idx / 2$ is the node parent index</li>
<li>$2 * element\_idx$ is an index of the left child</li>
<li>$2 * element\_idx + 1$ is an index of the right child</li>
</ul>
<p>where $element\_idx$ is some node index.</p>
<p>Additionally, the binary tree has the following useful properties:</p>
<ul>
<li>Heigh of the tree is $ln(N) + 1$</li>
</ul>
<p>The "nearly complete" means that <strong>not all tree levels</strong> may be <strong>filled out</strong> by leaf nodes (nodes without children). In other words, we can have a heap with any number of items.</p>
<p>The heap has a distinct property that actually makes it helpful:</p>
<ul>
<li>all children node values should be <strong>less or equal</strong> to the parent node value (<strong>the max-heap property</strong>)</li>
<li>or all children node values should be <strong>greater or equal</strong> to the parent node value (<strong>the min-heap property</strong>)</li>
</ul>
<p>To explain how all of this can be useful, we are going to implement the main heap functions from scratch.</p>
<h2 id="heap-building" style="position:relative;"><a href="#heap-building" aria-label="heap building permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Heap Building</h2>
<p>There is going to be a custom <code class="language-text">PriorityQueue</code> class which takes an arbitrary array of integers, make a heap from it and sustain the heap property during all operations.</p>
<p>The first thing we need to do is to build a max heap from an unsorted array. We can already visualize the array as a heap, but it would <strong>luck the max heap property</strong>.</p>
<p>Notice that <strong>leaf nodes can't violate the heap property</strong> since they don't have any child nodes. Hence, we can start looking at possible violations from the second-to-last level. The index of the last parent element on that level we can get via <code class="language-text">n // 2</code> where <code class="language-text">n</code> is the size of the array.</p>
<p>We start moving from right to left, from the bottom to the top of the heap. For each parent node, we need to make sure that the property of the heap holds true. If there is any violations, we just switch the current parent node with a child node that is greater than it (which violates the heap property).</p>
<p>However, this switching of the nodes may create a new violation on the levels below. So we need to perform the same procedure again for a node that became a child.</p>
<p>
		<video
			src=/57048b8030e0ab8ba4571d2ab2920604/heapify.mp4
			width="100%"
			height="auto"
			preload="auto"
			muted="true"
			title="Building a heap"
			autoplay
			playsinline
			controls
			loop
		></video>
	</p>
<div class="image-title">Max Heapifying</div>
<p>Here is how this can be implemented:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> List


<span class="token keyword">class</span> <span class="token class-name">PriorityQueue</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> items<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>items <span class="token operator">=</span> self<span class="token punctuation">.</span>build_heap<span class="token punctuation">(</span>items<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">build_heap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> items<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            items <span class="token operator">=</span> self<span class="token punctuation">.</span>heapify<span class="token punctuation">(</span>items<span class="token punctuation">,</span> i<span class="token punctuation">)</span>

        <span class="token keyword">return</span> items

    <span class="token keyword">def</span> <span class="token function">heapify</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> items<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> node_idx<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span>
        largest_idx <span class="token operator">=</span> node_idx

        <span class="token comment"># formulas for zero-indexed arrays</span>
        left_child_idx <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> node_idx <span class="token operator">+</span> <span class="token number">1</span>
        right_child_idx <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> node_idx <span class="token operator">+</span> <span class="token number">2</span>

        <span class="token keyword">if</span> left_child_idx <span class="token operator">&lt;</span> n <span class="token keyword">and</span> items<span class="token punctuation">[</span>left_child_idx<span class="token punctuation">]</span> <span class="token operator">></span> items<span class="token punctuation">[</span>largest_idx<span class="token punctuation">]</span><span class="token punctuation">:</span>
            largest_idx <span class="token operator">=</span> left_child_idx

        <span class="token keyword">if</span> right_child_idx <span class="token operator">&lt;</span> n <span class="token keyword">and</span> items<span class="token punctuation">[</span>right_child_idx<span class="token punctuation">]</span> <span class="token operator">></span> items<span class="token punctuation">[</span>largest_idx<span class="token punctuation">]</span><span class="token punctuation">:</span>
            largest_idx <span class="token operator">=</span> right_child_idx

        <span class="token keyword">if</span> largest_idx <span class="token operator">!=</span> node_idx<span class="token punctuation">:</span>
            tmp <span class="token operator">=</span> items<span class="token punctuation">[</span>node_idx<span class="token punctuation">]</span>
            items<span class="token punctuation">[</span>node_idx<span class="token punctuation">]</span> <span class="token operator">=</span> items<span class="token punctuation">[</span>largest_idx<span class="token punctuation">]</span>
            items<span class="token punctuation">[</span>largest_idx<span class="token punctuation">]</span> <span class="token operator">=</span> tmp

            <span class="token keyword">return</span> self<span class="token punctuation">.</span>heapify<span class="token punctuation">(</span>items<span class="token punctuation">,</span> largest_idx<span class="token punctuation">)</span>

        <span class="token keyword">return</span> items

    <span class="token keyword">def</span> <span class="token function">size</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>items<span class="token punctuation">)</span></code></pre></div>
<p>Complexity of this algorithm is $\Theta(n log(n))$.</p>
<h2 id="adding-a-new-element" style="position:relative;"><a href="#adding-a-new-element" aria-label="adding a new element permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Adding a New Element</h2>
<p>Another useful method to have is adding a new item to the heap. In this case, it's convenient to add a new item as a leaf node in the end of the heap array. This makes sure there are no violations below it. However, there may be some going upward. That's why we need to go all the way up and check whenever parent nodes are greater than the new item. If they are not, we will switch their positions.</p>
<p>Since the max heap property had stayed true before we add the new item, it's sufficient for us to check only parent nodes as we know that all child nodes should be less or equal to the parent value. </p>
<p>
		<video
			src=/504273255cec707881a6d5ccbc3f91a9/insert-a-new-item-to-the-heap.mp4
			width="100%"
			height="auto"
			preload="auto"
			muted="true"
			title="Insert a new item to the heap"
			autoplay
			playsinline
			controls
			loop
		></video>
	</p>
<div class="image-title">Insert a new item to the heap</div>
<p>Now we can take a look at the implementation:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">push</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>items<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>

    idx <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>items<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
    parent_idx <span class="token operator">=</span> idx <span class="token operator">//</span> <span class="token number">2</span>

    <span class="token keyword">if</span> idx <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment"># calculating parents in zero-indexed array</span>
        parent_idx <span class="token operator">-=</span> <span class="token number">1</span>

    <span class="token keyword">while</span> idx <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">and</span> self<span class="token punctuation">.</span>items<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">></span> self<span class="token punctuation">.</span>items<span class="token punctuation">[</span>parent_idx<span class="token punctuation">]</span><span class="token punctuation">:</span>
        tmp <span class="token operator">=</span> self<span class="token punctuation">.</span>items<span class="token punctuation">[</span>parent_idx<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>items<span class="token punctuation">[</span>parent_idx<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>items<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>items<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> tmp

        idx <span class="token operator">=</span> parent_idx
        parent_idx <span class="token operator">=</span> idx <span class="token operator">//</span> <span class="token number">2</span>

        <span class="token keyword">if</span> idx <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token comment"># calculating parents in zero-indexed array</span>
            parent_idx <span class="token operator">-=</span> <span class="token number">1</span></code></pre></div>
<p>The complexity of heap inserting algorithm is $\Theta(log(n))$ since at each interaction we traversal another tree level.</p>
<h2 id="extracting-the-max-element" style="position:relative;"><a href="#extracting-the-max-element" aria-label="extracting the max element permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Extracting The Max Element</h2>
<p>The key method of the heap is extracting the max element. Because of the heap property, the max element should always stay that the top of the heap. So it's as simple as call <code class="language-text">self.items[0]</code> to get it.</p>
<p>That's not all. The extraction would remove the element from the heap and we can not just leave it with a "hole". Instead, we need to put the next max element there.</p>
<p>Like before, the safest way is to <strong>replace the hole with the last leaf node</strong> (not to change the heap property in other branches of the heap). The last item is just handy to use, but it's not necessarily the next needed candidate to be at the top of the heap. To make sure, we need to run the <code class="language-text">heapify()</code> method which recursively fixes all violations.</p>
<p>
		<video
			src=/ac4d4e7e997ecd484aade4d0f2c10cb1/extract-max-element-from-the-heap.mp4
			width="100%"
			height="auto"
			preload="auto"
			muted="true"
			title="Extract the max element from the heap"
			autoplay
			playsinline
			controls
			loop
		></video>
	</p>
<div class="image-title">Extract the max element from the heap</div>
<p>The implementation is straightforward:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">pop</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    item <span class="token operator">=</span> self<span class="token punctuation">.</span>items<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>items<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>items<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>items<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># replace extracted max element with one of the balanced leaves</span>
    <span class="token keyword">del</span> self<span class="token punctuation">.</span>items<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>

    self<span class="token punctuation">.</span>items <span class="token operator">=</span> self<span class="token punctuation">.</span>heapify<span class="token punctuation">(</span>self<span class="token punctuation">.</span>items<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> item</code></pre></div>
<p>The complexity of heap items extracting algorithm is $\Theta(log(n))$. Nevertheless, we can get access to the current max element in $\Theta(1)$.</p>
<h2 id="heap-sort" style="position:relative;"><a href="#heap-sort" aria-label="heap sort permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Heap Sort</h2>
<p>Now we have all components to implement one of the most frequent applications of the priority queue - the heap sorting.</p>
<p>Heap sort is just the extraction of <code class="language-text">n</code> elements from the heap.</p>
<p>
		<video
			src=/c73facee0c9e850b4562b7b8c5b5cab8/heap-sort.mp4
			width="100%"
			height="auto"
			preload="auto"
			muted="true"
			title="Heap Sort In Action"
			autoplay
			playsinline
			controls
			loop
		></video>
	</p>
<div class="image-title">Heap Sort In Action</div>
<p>This is how it looks like in Python:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">heap_sort</span><span class="token punctuation">(</span>heap<span class="token punctuation">:</span> PriorityQueue<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heap<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>heap<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> result</code></pre></div>
<p>The complexity of heap sorting is $\Theta(nlog(n))$. Besides that, heap sorting doesn't require any additional memory for storing elements during sorting.</p>
<h2 id="applications" style="position:relative;"><a href="#applications" aria-label="applications permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Applications</h2>
<p>Heap sorting is not the only application of the priority queue. Here are a few more cases where heaps are being applied:</p>
<ul>
<li>access to a limited resource like making sure your Zoom application has a high network bandwidth priority, hence, lower latency</li>
<li>device interruption handling like pressing a key on the keyboard triggers a specific interruption handler that rads a key value and send it to the OS. There is an interruption latency associated with this process and interruptions from some devices we wish to be processed as soon as possible</li>
<li>the heap can be used during searching for <a target="_blank" rel="noopener nofollow" href="/blog/k-nearest-neighbors/">K-Nearest Neighbors</a></li>
</ul>
<p>Broadly speaking, the heap may be used everywhere where we need to keep track of the list of min or max elements that may be changed during the runtime.</p>
<h2 id="heapq" style="position:relative;"><a href="#heapq" aria-label="heapq permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>heapq</h2>
<p>Thankfully, it's not required to implement the heap yourself everytime you need it. Python provides a library called <a target="_blank" rel="noopener nofollow" href="https://docs.python.org/3/library/heapq.html">heapq</a> which is a set of functions that operates on the "heapified" array preserving the min-heap property.</p>
<p>The min-heap sort can be implemented this way:</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> heapq

heap <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">]</span>
heapq<span class="token punctuation">.</span>heapify<span class="token punctuation">(</span>heap<span class="token punctuation">)</span>

result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heap<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>heapq<span class="token punctuation">.</span>heappop<span class="token punctuation">(</span>heap<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<h2 id="practice" style="position:relative;"><a href="#practice" aria-label="practice permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Practice</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://leetcode.com/problems/last-stone-weight/">[Leetcode] 1046. Last Stone Weight</a></li>
<li><a target="_blank" rel="noopener" href="https://leetcode.com/problems/single-threaded-cpu/">[Leetcode] 1834. Single-Threaded CPU</a></li>
<li><a target="_blank" rel="noopener" href="https://leetcode.com/problems/find-k-th-smallest-pair-distance/">[Leetcode] 719. Find K-th Smallest Pair Distance</a></li>
</ul>
<h2 id="summary" style="position:relative;"><a href="#summary" aria-label="summary permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Summary</h2>
<p>In this article, we have reviewed how to implement a priority queue, what properties it has and how it can be helpful.</p>
<p>If the heap concept was new for you, try to do a few problems from the practice section.</p>
<p>Finally, let me in the comments what unusual applications of heaps have you seen in your practice.</p>
<h2 id="references" style="position:relative;"><a href="#references" aria-label="references permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>References</h2>
<ul>
<li><a target="_blank" rel="noopener nofollow" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-006-introduction-to-algorithms-fall-2011/lecture-videos/lecture-4-heaps-and-heap-sort/">MIT 6.006 - Heaps and Heap Sort</a></li>
<li><a target="_blank" rel="noopener nofollow" href="https://visualgo.net/en/heap">Heap Visualized</a></li>
</ul></div></div><div id="content-end"></div></article><div class="social-share-wrapper"><h3>Share Your Love</h3><button aria-label="Share Via Facebook" title="Share Via Facebook" class="react-share__ShareButton social-share-item facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook" class="svg-inline--fa fa-facebook fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path></svg></button><button aria-label="Share Via Twitter" class="react-share__ShareButton social-share-item twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></button><button aria-label="Share Via LinkedIn" class="react-share__ShareButton social-share-item linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin-in" class="svg-inline--fa fa-linkedin-in fa-w-14 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg></button><button aria-label="Share Via Reddit" class="react-share__ShareButton social-share-item reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit" class="svg-inline--fa fa-reddit fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"></path></svg></button><button aria-label="Add to Pocket" class="react-share__ShareButton social-share-item pocket" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="get-pocket" class="svg-inline--fa fa-get-pocket fa-w-14 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M407.6 64h-367C18.5 64 0 82.5 0 104.6v135.2C0 364.5 99.7 464 224.2 464c124 0 223.8-99.5 223.8-224.2V104.6c0-22.4-17.7-40.6-40.4-40.6zm-162 268.5c-12.4 11.8-31.4 11.1-42.4 0C89.5 223.6 88.3 227.4 88.3 209.3c0-16.9 13.8-30.7 30.7-30.7 17 0 16.1 3.8 105.2 89.3 90.6-86.9 88.6-89.3 105.5-89.3 16.9 0 30.7 13.8 30.7 30.7 0 17.8-2.9 15.7-114.8 123.2z"></path></svg></button></div><div class="newsletter-form"><iframe src="https://romanglushko.substack.com/embed" loading="lazy" width="100%" height="320" style="border:1px solid #EEE" frameborder="0" scrolling="no"></iframe></div><div class="comment-box"></div></main><aside class="blogpost-sidebar"><div class="blog-navigation-wrapper"><h3>Read Other Posts</h3><nav class="blog-navigation"><div class="nav-links"><a rel="next" class="next-post" href="/blog/how-i-built-my-ml-workstation/">How I built my ML workstation 🔬<!-- --> →</a><a class="all-posts" href="/blog/">All Posts</a></div></nav></div></aside><footer><div class="footer-wrapper"><div class="social"><ul class="social-list"><li class="social-item social-linkedin"><a rel="me" itemprop="url" href="https://www.linkedin.com/in/glushko-roman" title="Roman Glushko on LinkedIn" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin-in" class="svg-inline--fa fa-linkedin-in fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg></a></li><li class="social-item social-github"><a rel="me" itemprop="url" href="https://github.com/roma-glushko" title="Roman Glushko on Github" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github-alt" class="svg-inline--fa fa-github-alt fa-w-15 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path fill="currentColor" d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg></a></li><li class="social-item social-email"><a itemprop="email" href="mailto:roman.glushko.m@gmail.com" title="Roman Glushko&#x27;s Email"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-w-16 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></li><li class="social-item social-kaggle"><a rel="me" itemprop="url" href="https://www.kaggle.com/glushko" title="Roman Glushko on Kaggle" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="kaggle" class="svg-inline--fa fa-kaggle fa-w-10 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M304.2 501.5L158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5 0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5 0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25 0 6-3z"></path></svg></a></li><li class="social-item social-twitter"><a rel="me" itemprop="url" href="https://twitter.com/roma_glushko" title="Roman Glushko on Twitter" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-w-16 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li></ul></div><div class="copyright">Roman Glushko © 1996 - <!-- -->2021<!-- --> <br/><a rel="license" href="https://creativecommons.org/licenses/by/4.0/" title="Content is published under CC BY 4.0 license">CC BY 4.0</a></div></div></footer><div class="mathjax"></div><span></span></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-148139633-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-148139633-1', 'auto', {"alwaysSendReferrer":true});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/heapify/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-a404a4d28af389c419da.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-24fd6ae4cd626a83669a.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d29e34ec799ab1ab12b8.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-c12e2568fda77e2eedb9.js"],"component---src-pages-cv-ecommerce-developer-js":["/component---src-pages-cv-ecommerce-developer-js-cd6d98500477105b69a7.js"],"component---src-pages-cv-machine-learning-engineer-js":["/component---src-pages-cv-machine-learning-engineer-js-d16d3aeaec7c78a5208a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-569647c7fc9ad0b4ff62.js"],"component---src-pages-indexv-2-js":["/component---src-pages-indexv-2-js-deb4bdea44a55d8ec4af.js"],"component---src-pages-lab-js":["/component---src-pages-lab-js-4db5954482c0e0befe27.js"],"component---src-pages-lab-rockpaperscissor-index-js":["/component---src-pages-lab-rockpaperscissor-index-js-0048c7046abee6fc4393.js"],"component---src-pages-nn-design-js":["/component---src-pages-nn-design-js-f2c6b4c37930954e2622.js"],"component---src-pages-thoughts-js":["/component---src-pages-thoughts-js-23890bf298621dcece23.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-36c6e9a028bb065c2789.js"],"component---src-templates-thought-template-js":["/component---src-templates-thought-template-js-2355187bbac177698d1c.js"]};/*]]>*/</script><script src="/component---src-templates-blog-template-js-36c6e9a028bb065c2789.js" async=""></script><script src="/4622c33586ad0108e870f951288ae6aa3beabfab-fcb43bc1a7ce17b71bb1.js" async=""></script><script src="/f6376c28e68891f114e55d85fa576119f254df6d-f70e1702cd36f0e54f95.js" async=""></script><script src="/96edb7a57f086d01df9dd5de2930bc5d14d74576-d1cec564a349ac9a8364.js" async=""></script><script src="/5b6787de1fc21416001f14661dbb6de4fdaa6cae-128c3c7f9700dacdcc25.js" async=""></script><script src="/a9a7754c-52ee971a981a422e7452.js" async=""></script><script src="/cb1608f2-6457b2b7ea9500c04ebb.js" async=""></script><script src="/styles-8636a280cbc61d53ad10.js" async=""></script><script src="/app-a404a4d28af389c419da.js" async=""></script><script src="/framework-210242e7bdc0a51564c1.js" async=""></script><script src="/webpack-runtime-9bd2d682a8ce326f2399.js" async=""></script></body></html>